# PPTæ™ºèƒ½æ›´æ–°åŠ©æ‰‹ (PPT Update Agent)

ä¸€ä¸ªåŸºäºAIçš„PowerPointæ¼”ç¤ºæ–‡ç¨¿æ™ºèƒ½æ›´æ–°ç³»ç»Ÿï¼Œèƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹PPTä¸­è¿‡æ—¶çš„å†…å®¹å¹¶é€šè¿‡ç½‘ç»œæœç´¢è·å–æœ€æ–°ä¿¡æ¯è¿›è¡Œæ›´æ–°å»ºè®®ã€‚

## ğŸŒŸ é¡¹ç›®ç‰¹è‰²

- **æ™ºèƒ½å†…å®¹åˆ†æ**: ä½¿ç”¨å¤§è¯­è¨€æ¨¡å‹è‡ªåŠ¨è¯†åˆ«PPTä¸­å¯èƒ½è¿‡æ—¶çš„æ–°é—»ã€æ•°æ®å’Œäº‹å®
- **å®æ—¶ä¿¡æ¯æœç´¢**: é€šè¿‡MCP (Model Context Protocol) æ¡†æ¶é›†æˆå¤šç§æœç´¢å·¥å…·
- **å¯è§†åŒ–ç•Œé¢**: åŸºäºStreamlitçš„ç”¨æˆ·å‹å¥½ç•Œé¢ï¼Œæ”¯æŒæ–‡ä»¶ä¸Šä¼ å’Œç»“æœå±•ç¤º
- **å¤šæ ¼å¼æ”¯æŒ**: æ”¯æŒ.pptxæ ¼å¼çš„PowerPointæ–‡ä»¶è§£æ
- **è¯¦ç»†æŠ¥å‘Š**: ç”ŸæˆåŒ…å«åŸå†…å®¹ã€æ›´æ–°å»ºè®®å’Œæœç´¢æ¥æºçš„è¯¦ç»†æŠ¥å‘Š

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

```
PPT_Update_Agent/
â”œâ”€â”€ PPT_update_agent/           # ä¸»è¦åº”ç”¨æ¨¡å—
â”‚   â”œâ”€â”€ streamlit_app.py        # Streamlit Webç•Œé¢
â”‚   â”œâ”€â”€ ppt_update_agent_full.py # æ ¸å¿ƒæ›´æ–°Agent
â”‚   â”œâ”€â”€ ppt_parser.py           # PPTæ–‡ä»¶è§£æå™¨
â”‚   â”œâ”€â”€ ppt_update_apply.py     # æ›´æ–°åº”ç”¨æ¨¡å—
â”‚   â”œâ”€â”€ browser_mcp.json        # MCPæœåŠ¡å™¨é…ç½®
â”‚   â””â”€â”€ mcp_test.py            # MCPæµ‹è¯•è„šæœ¬
â”œâ”€â”€ mcp_use_new/               # MCPæ¡†æ¶å®ç°
â”‚   â”œâ”€â”€ agents/                # Agentç›¸å…³æ¨¡å—
â”‚   â”œâ”€â”€ adapters/              # é€‚é…å™¨æ¨¡å—
â”‚   â”œâ”€â”€ connectors/            # è¿æ¥å™¨æ¨¡å—
â”‚   â”œâ”€â”€ task_managers/         # ä»»åŠ¡ç®¡ç†å™¨
â”‚   â””â”€â”€ client.py              # MCPå®¢æˆ·ç«¯
â”œâ”€â”€ requirements.txt           # é¡¹ç›®ä¾èµ–
â””â”€â”€ README.md                 # é¡¹ç›®æ–‡æ¡£
```

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

### 1. PPTå†…å®¹è§£æ
- æå–å¹»ç¯ç‰‡ä¸­çš„æ–‡æœ¬ã€è¡¨æ ¼ã€å›¾ç‰‡ä¿¡æ¯
- æ”¯æŒæ ‡é¢˜ã€æ­£æ–‡ã€å¤‡æ³¨çš„åˆ†ç±»è¯†åˆ«
- å°†è¡¨æ ¼æ•°æ®è½¬æ¢ä¸ºPandas DataFrameæ ¼å¼

### 2. æ™ºèƒ½å†…å®¹åˆ†æ
- ä½¿ç”¨DeepSeekå¤§è¯­è¨€æ¨¡å‹åˆ†æå†…å®¹æ—¶æ•ˆæ€§
- è¯†åˆ«åŒ…å«æ—¥æœŸã€æ•°æ®ã€æ–°é—»ç­‰å¯èƒ½è¿‡æ—¶çš„ä¿¡æ¯
- ç”Ÿæˆé’ˆå¯¹æ€§çš„æœç´¢å…³é”®è¯

### 3. å®æ—¶ä¿¡æ¯æœç´¢
- åŸºäºMCPæ¡†æ¶é›†æˆå¤šç§æœç´¢æœåŠ¡
- æ”¯æŒTavilyæœç´¢ã€ArXivå­¦æœ¯æœç´¢ç­‰
- è·å–æœ€æ–°ã€å¯é çš„ä¿¡æ¯æ¥æº

### 4. æ›´æ–°å»ºè®®ç”Ÿæˆ
- åŸºäºæœç´¢ç»“æœç”Ÿæˆé€‚åˆPPTå±•ç¤ºçš„æ›´æ–°å†…å®¹
- ä¿æŒåŸæœ‰æ ¼å¼å’Œé£æ ¼çš„ä¸€è‡´æ€§
- æä¾›è¯¦ç»†çš„æ›´æ–°ç†ç”±å’Œä¿¡æ¯æ¥æº

## ğŸ“‹ ç³»ç»Ÿè¦æ±‚

- Python 3.8+
- Windows 10/11 (æ”¯æŒpywin32)
- è‡³å°‘4GB RAM
- ç½‘ç»œè¿æ¥ (ç”¨äºAPIè°ƒç”¨å’Œä¿¡æ¯æœç´¢)

## ğŸ› ï¸ å®‰è£…æŒ‡å—

### 1. å…‹éš†é¡¹ç›®
```bash
git clone <repository-url>
cd PPT_Update_Agent
```

### 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
```bash
python -m venv venv
venv\Scripts\activate  # Windows
# æˆ–
source venv/bin/activate  # Linux/Mac
```

### 3. å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

### 4. é…ç½®APIå¯†é’¥
åˆ›å»º`.env`æ–‡ä»¶å¹¶æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š
```env
DEEPSEEK_API_KEY=your_deepseek_api_key_here
TAVILY_API_KEY=your_tavily_api_key_here  # å¯é€‰
```

### 5. é…ç½®MCPæœåŠ¡å™¨
ç¼–è¾‘`PPT_update_agent/browser_mcp.json`æ–‡ä»¶ï¼Œé…ç½®æ‰€éœ€çš„MCPæœåŠ¡å™¨ï¼š
```json
{
  "mcpServers": {
    "fetch": {
      "type": "sse",
      "url": "your_fetch_server_url"
    },
    "tavily-mcp": {
      "type": "sse",
      "url": "your_tavily_server_url"
    }
  }
}
```

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•ä¸€ï¼šWebç•Œé¢ (æ¨è)
```bash
cd PPT_update_agent
streamlit run streamlit_app.py
```

ç„¶ååœ¨æµè§ˆå™¨ä¸­è®¿é—® `http://localhost:8501`

#### Webç•Œé¢åŠŸèƒ½ï¼š
1. **æ–‡ä»¶ä¸Šä¼ **: æ‹–æ‹½æˆ–é€‰æ‹©.pptxæ–‡ä»¶
2. **å†…å®¹é¢„è§ˆ**: æŸ¥çœ‹PPTçš„æ–‡æœ¬ã€è¡¨æ ¼ã€å›¾ç‰‡å†…å®¹
3. **æ™ºèƒ½åˆ†æ**: é€‰æ‹©è¦åˆ†æçš„å¹»ç¯ç‰‡å¹¶å¼€å§‹åˆ†æ
4. **ç»“æœæŸ¥çœ‹**: æŸ¥çœ‹åŸå†…å®¹ä¸æ›´æ–°å»ºè®®çš„å¯¹æ¯”
5. **æŠ¥å‘Šå¯¼å‡º**: å¯¼å‡ºJSONæ ¼å¼çš„è¯¦ç»†åˆ†ææŠ¥å‘Š

### æ–¹æ³•äºŒï¼šå‘½ä»¤è¡Œç•Œé¢
```bash
cd PPT_update_agent
python ppt_update_agent_full.py --ppt "path/to/your/presentation.pptx" --slides 1,2,3
```

#### å‘½ä»¤è¡Œå‚æ•°ï¼š
- `--ppt`: PPTæ–‡ä»¶è·¯å¾„ (å¿…éœ€)
- `--slides`: è¦å¤„ç†çš„å¹»ç¯ç‰‡ç¼–å·ï¼Œç”¨é€—å·åˆ†éš” (å¯é€‰ï¼Œé»˜è®¤å¤„ç†æ‰€æœ‰)
- `--config`: MCPé…ç½®æ–‡ä»¶è·¯å¾„ (å¯é€‰)
- `--output`: ç»“æœè¾“å‡ºæ–‡ä»¶è·¯å¾„ (å¯é€‰)

### æ–¹æ³•ä¸‰ï¼šPython API
```python
import asyncio
from PPT_update_agent.ppt_update_agent_full import PPTUpdateAgent

async def main():
    # åˆå§‹åŒ–Agent
    agent = PPTUpdateAgent("browser_mcp.json")
    await agent.initialize()

    # å¤„ç†PPT
    result = await agent.process_ppt("presentation.pptx", slides=[1, 2])

    # æŸ¥çœ‹ç»“æœ
    print(result)

    # å…³é—­Agent
    await agent.close()

asyncio.run(main())
```

## ğŸ“Š è¾“å‡ºæ ¼å¼

ç³»ç»Ÿä¼šç”ŸæˆåŒ…å«ä»¥ä¸‹ä¿¡æ¯çš„è¯¦ç»†æŠ¥å‘Šï¼š

```json
{
  "æ–‡ä»¶": "presentation.pptx",
  "åˆ†ææ—¶é—´": "2024-01-01 12:00:00",
  "å¤„ç†çš„å¹»ç¯ç‰‡": [1, 2, 3],
  "ç»“æœ": [
    {
      "å¹»ç¯ç‰‡": 1,
      "æ›´æ–°å†…å®¹": [
        {
          "åŸå†…å®¹": "2023å¹´çš„å¸‚åœºæ•°æ®æ˜¾ç¤º...",
          "æ›´æ–°å†…å®¹": "2024å¹´æœ€æ–°å¸‚åœºæ•°æ®æ˜¾ç¤º...",
          "æœç´¢å…³é”®è¯": "2024å¹´å¸‚åœºæ•°æ® æœ€æ–°ç»Ÿè®¡",
          "æœç´¢ç»“æœ": "è¯¦ç»†çš„æœç´¢ç»“æœå’Œæ¥æºä¿¡æ¯..."
        }
      ]
    }
  ]
}
```

## ğŸ”§ é…ç½®è¯´æ˜

### DeepSeek APIé…ç½®
1. è®¿é—® [DeepSeekå®˜ç½‘](https://platform.deepseek.com/) æ³¨å†Œè´¦æˆ·
2. è·å–APIå¯†é’¥
3. åœ¨`.env`æ–‡ä»¶ä¸­è®¾ç½®`DEEPSEEK_API_KEY`

### MCPæœåŠ¡å™¨é…ç½®
é¡¹ç›®ä½¿ç”¨MCP (Model Context Protocol) æ¡†æ¶é›†æˆå¤–éƒ¨å·¥å…·ï¼š

- **FetchæœåŠ¡å™¨**: ç”¨äºç½‘é¡µå†…å®¹è·å–
- **Tavilyæœç´¢**: æä¾›å®æ—¶æœç´¢åŠŸèƒ½
- **ArXivæœåŠ¡å™¨**: ç”¨äºå­¦æœ¯è®ºæ–‡æœç´¢

## ğŸ§ª æµ‹è¯•

### è¿è¡Œå•å…ƒæµ‹è¯•
```bash
python -m pytest tests/
```

### æµ‹è¯•PPTè§£æåŠŸèƒ½
```bash
cd PPT_update_agent
python ppt_parser.py sample.pptx
```

### æµ‹è¯•MCPè¿æ¥
```bash
cd PPT_update_agent
python mcp_test.py
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **APIä½™é¢ä¸è¶³**
   - é”™è¯¯ä¿¡æ¯ï¼š`Insufficient Balance`
   - è§£å†³æ–¹æ¡ˆï¼šç™»å½•DeepSeekå®˜ç½‘å……å€¼è´¦æˆ·

2. **MCPæœåŠ¡å™¨è¿æ¥å¤±è´¥**
   - æ£€æŸ¥`browser_mcp.json`é…ç½®æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸
   - éªŒè¯æœåŠ¡å™¨URLæ˜¯å¦æœ‰æ•ˆ

3. **PPTæ–‡ä»¶è§£æå¤±è´¥**
   - ç¡®ä¿æ–‡ä»¶æ ¼å¼ä¸º.pptx
   - æ£€æŸ¥æ–‡ä»¶æ˜¯å¦æŸå
   - ç¡®è®¤æ–‡ä»¶è·¯å¾„æ­£ç¡®

4. **ä¾èµ–å®‰è£…å¤±è´¥**
   - ä½¿ç”¨ç®¡ç†å‘˜æƒé™è¿è¡Œå‘½ä»¤æç¤ºç¬¦
   - æ›´æ–°pipï¼š`python -m pip install --upgrade pip`
   - å•ç‹¬å®‰è£…é—®é¢˜ä¾èµ–ï¼š`pip install package_name`

### æ—¥å¿—è°ƒè¯•
å¯ç”¨è¯¦ç»†æ—¥å¿—è¾“å‡ºï¼š
```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Forkæœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ï¼š`git checkout -b feature/new-feature`
3. æäº¤æ›´æ”¹ï¼š`git commit -am 'Add new feature'`
4. æ¨é€åˆ†æ”¯ï¼š`git push origin feature/new-feature`
5. åˆ›å»ºPull Request

### ä»£ç è§„èŒƒ
- ä½¿ç”¨Python PEP 8ç¼–ç è§„èŒƒ
- æ·»åŠ é€‚å½“çš„æ³¨é‡Šå’Œæ–‡æ¡£å­—ç¬¦ä¸²
- ç¼–å†™å•å…ƒæµ‹è¯•è¦†ç›–æ–°åŠŸèƒ½
- ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ - è¯¦è§[LICENSE](LICENSE)æ–‡ä»¶

## ğŸ™ è‡´è°¢

- [DeepSeek](https://platform.deepseek.com/) - æä¾›å¼ºå¤§çš„å¤§è¯­è¨€æ¨¡å‹API
- [LangChain](https://langchain.com/) - æä¾›LLMåº”ç”¨å¼€å‘æ¡†æ¶
- [Streamlit](https://streamlit.io/) - æä¾›å¿«é€ŸWebåº”ç”¨å¼€å‘æ¡†æ¶
- [python-pptx](https://python-pptx.readthedocs.io/) - æä¾›PowerPointæ–‡ä»¶å¤„ç†èƒ½åŠ›

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- æäº¤Issueï¼š[GitHub Issues](https://github.com/your-repo/issues)
- é‚®ç®±ï¼šyour-email@example.com

---

**æ³¨æ„**: æœ¬é¡¹ç›®ä»…ç”¨äºå­¦ä¹ å’Œç ”ç©¶ç›®çš„ã€‚ä½¿ç”¨æ—¶è¯·éµå®ˆç›¸å…³APIæœåŠ¡çš„ä½¿ç”¨æ¡æ¬¾å’Œé™åˆ¶ã€‚